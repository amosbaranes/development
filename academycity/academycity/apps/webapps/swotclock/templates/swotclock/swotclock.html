{% load static i18n cms_tags menu_tags sekizai_tags thumbnail %}
{% load static %}

<style>


/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 7px 16px;
  transition: 0.3s;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: rgb(255,102,255);
  font-weight: bold;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
  background-color: white;
}

.tableswot {
  text-align: center;
  width: 700;
  border: 1px solid black;
  background-color: white;
}


.tdswot {
  height: 20;
  background-color: white;
}

.inputfactor{
 width: 200px;
 background: rgb(255,255,51);
 font-weight: bold;
 text-align: left;
}
.inputmeasure{
 width: 350px;
 font-weight: bold;
 text-align: left;
}

.inputswotval{
  width: 40;
  background: rgb(0,204,0);
  text-align: center;
  font-weight: bold;
}

.inputswotvalscale{
  width: 60;
  background: rgb(255,204,255);
  text-align: center;
  font-weight: bold;
}

.inputswotweighted{
  width: 40;
  background: rgb(255,153,102);
  text-align: center;
  font-weight: bold;
}

.inputswotsum{
  width: 40;
  background: rgb(255,102,255);
  text-align: center;
  font-weight: bold;
}

.inputwifname{
  width: 80;
  background: rgb(0,204,255);
  text-align: center;
  font-weight: bold;
}

.inputwiftotal {
  width: 80;
  background: rgb(255,255,0);
  text-align: center;
  font-weight: bold;
}

.inputwifval {
  width: 80;
  background: rgb(255,255,255);
  text-align: center;
  font-weight: bold;
}

.inputswotanalysis{
  width: 100;
  background: rgb(255,153,0);
  text-align: center;
  font-weight: bold;
}

.inputswotleadingstrategy{
  width: 100;
  background: rgb(176,176,176);
  text-align: center;
  font-weight: bold;
  font-weight: bold;
}

</style>

<script src="https://unpkg.com/mathjs@7.0.2/dist/math.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.css">

<br/>
<h1>SWOTCLOCK<sup>TM</sup></h1>
  <p>

  <span>Select file:
  <select id="filescombobox" style="width: 300px; height: 30px" name="filescombobox" onchange="filescomboboxchange()" >
    <option value="---Select---">--- Select file ---</option>
  </select>
  </span>
    <button onClick="get_user_swot()" style="height:30px; width:200px">Refresh file list</button>
    <button onClick="save_data(is_new='0')" style="height:30px; width:200px">Save current file</button>
    <button onClick="save_data(is_new='1')" style="height:30px; width:200px">Save as new file</button>
    <button onClick="resetForm()">Clear data</button>
    <button onClick="delete_data()">Delete file</button>
  </p>

<div class="tab" onclick="openTab(event)">
  <button id="btn_dimond" class="tablinks" tab_type="dimond" >SWOTCLOCK Data</button>
  <button id="btn_weighted" class="tablinks" tab_type="weighted" >Weighted Factors Data</button>
  <button id="btn_analysis" class="tablinks" tab_type="analysis" >SWOTCLOCK Analysis</button>
</div>

<div id="dimond" class="tabcontent">
<style>
  #plugin tr:nth-child(even){background-color: white;}
  #plugint tr:hover {background-color: #e6eeff;}

  #plugin table, #plugin th, #plugin td, #plugin tr {
    padding-top: 0px;
    padding-bottom: 5px;
    background-color: white;
    border: 0px;
  }
</style>

<form id="swotform" method="post">

<TABLE class="tableswot">
  <TR>
  <td class="tdswot" colspan="11" style="text-align:center"><b>Scale</b></td>
  </TR>
  <TR>
  <td></td><td></td><td colspan="3" style="text-align:center"><b>Strength</b></td><td colspan="3" style="text-align:center"><b>Weakness</b></td><td><b>Strength</b></td><td><b>Weakness</b></td><td><b>Weighted</b></td>
  </TR>
  <TR>
  <td style="text-align:center"><b>Firm Factor</b></td><td style="text-align:center"><b>Key Performance Indicator (KPI)</b></td><td style="text-align:center"><b>Low</b></td><td style="text-align:center"><b>Mid</b></td><td style="text-align:center"><b>High</b></td><td style="text-align:center"><b>Low</b></td><td style="text-align:center"><b>Mid</b></td style="text-align:center"><td><b>High</b></td><td><b>1-3</b></td><td><b>1-3</b></td><td><b>factor</b></td>
  </TR>
  <TR>
  <td><input id="sf_b_1" name="sf_b_1" class="inputfactor" onkeyup="sf_b_change(this)" value=""/></td><td><input id="sf_m_1" name="sf_m_1" class="inputmeasure"/></td><td><input id="sf_1_1" name="sf_1_1" class="inputswotvalscale"  /></td><td><input id="sf_1_2" name="sf_1_2" class="inputswotvalscale"  /></td><td><input id="sf_1_3" name="sf_1_3" class="inputswotvalscale"  /></td><td><input id="sf_1_4" name="sf_1_4" class="inputswotvalscale"  /></td><td><input id="sf_1_5" name="sf_1_5" class="inputswotvalscale"  /></td><td><input id="sf_1_6" name="sf_1_6" class="inputswotvalscale"  /></td><td><input id="sf_st_1" name="sf_st_1" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_1" name="sf_we_1" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_1" name="sf_w_1" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_2" name="sf_b_2" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_2" name="sf_m_2" class="inputmeasure"/></td><td><input id="sf_2_1" name="sf_2_1" class="inputswotvalscale" /></td><td><input id="sf_2_2" name="sf_2_2" class="inputswotvalscale" /></td><td><input id="sf_2_3" name="sf_2_3" class="inputswotvalscale" /></td><td><input id="sf_2_4" name="sf_2_4" class="inputswotvalscale" /></td><td><input id="sf_2_5" name="sf_2_5" class="inputswotvalscale" /></td><td><input id="sf_2_6" name="sf_2_6" class="inputswotvalscale" /></td><td><input id="sf_st_2" name="sf_st_2" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_2" name="sf_we_2" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_2" name="sf_w_2" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_3" name="sf_b_3" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_3" name="sf_m_3" class="inputmeasure"/></td><td><input id="sf_3_1" name="sf_3_1" class="inputswotvalscale" /></td><td><input id="sf_3_2" name="sf_3_2" class="inputswotvalscale"  /></td><td><input id="sf_3_3" name="sf_3_3" class="inputswotvalscale" /></td><td><input id="sf_3_4" name="sf_3_4" class="inputswotvalscale" /></td><td><input id="sf_3_5" name="sf_3_5" class="inputswotvalscale" /></td><td><input id="sf_3_6" name="sf_3_6" class="inputswotvalscale" /></td><td><input id="sf_st_3" name="sf_st_3" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_3" name="sf_we_3" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_3" name="sf_w_3" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_4" name="sf_b_4" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_4" name="sf_m_4" class="inputmeasure"/></td><td><input id="sf_4_1" name="sf_4_1" class="inputswotvalscale" /></td><td><input id="sf_4_2" name="sf_4_2" class="inputswotvalscale"  /></td><td><input id="sf_4_3" name="sf_4_3" class="inputswotvalscale" /></td><td><input id="sf_4_4" name="sf_4_4" class="inputswotvalscale" /></td><td><input id="sf_4_5" name="sf_4_5" class="inputswotvalscale" /></td><td><input id="sf_4_6" name="sf_4_6" class="inputswotvalscale" /></td><td><input id="sf_st_4" name="sf_st_4" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_4" name="sf_we_4" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_4" name="sf_w_4" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_5" name="sf_b_5" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_5" name="sf_m_5" class="inputmeasure"/></td><td><input id="sf_5_1" name="sf_5_1" class="inputswotvalscale" /></td><td><input id="sf_5_2" name="sf_5_2" class="inputswotvalscale"  /></td><td><input id="sf_5_3" name="sf_5_3" class="inputswotvalscale" /></td><td><input id="sf_5_4" name="sf_5_4" class="inputswotvalscale" /></td><td><input id="sf_5_5" name="sf_5_5" class="inputswotvalscale" /></td><td><input id="sf_5_6" name="sf_5_6" class="inputswotvalscale" /></td><td><input id="sf_st_5" name="sf_st_5" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_5" name="sf_we_5" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_5" name="sf_w_5" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_6" name="sf_b_6" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_6" name="sf_m_6" class="inputmeasure"/></td><td><input id="sf_6_1" name="sf_6_1" class="inputswotvalscale" /></td><td><input id="sf_6_2" name="sf_6_2" class="inputswotvalscale"  /></td><td><input id="sf_6_3" name="sf_6_3" class="inputswotvalscale" /></td><td><input id="sf_6_4" name="sf_6_4" class="inputswotvalscale" /></td><td><input id="sf_6_5" name="sf_6_5" class="inputswotvalscale" /></td><td><input id="sf_6_6" name="sf_6_6" class="inputswotvalscale" /></td><td><input id="sf_st_6" name="sf_st_6" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_6" name="sf_we_6" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_6" name="sf_w_6" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_7" name="sf_b_7" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_7" name="sf_m_7" class="inputmeasure"/></td><td><input id="sf_7_1" name="sf_7_1" class="inputswotvalscale" /></td><td><input id="sf_7_2" name="sf_7_2" class="inputswotvalscale"  /></td><td><input id="sf_7_3" name="sf_7_3" class="inputswotvalscale" /></td><td><input id="sf_7_4" name="sf_7_4" class="inputswotvalscale" /></td><td><input id="sf_7_5" name="sf_7_5" class="inputswotvalscale" /></td><td><input id="sf_7_6" name="sf_7_6" class="inputswotvalscale" /></td><td><input id="sf_st_7" name="sf_st_7" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_7" name="sf_we_7" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_7" name="sf_w_7" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_8" name="sf_b_8" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_8" name="sf_m_8" class="inputmeasure"/></td><td><input id="sf_8_1" name="sf_8_1" class="inputswotvalscale" /></td><td><input id="sf_8_2" name="sf_8_2" class="inputswotvalscale"  /></td><td><input id="sf_8_3" name="sf_8_3" class="inputswotvalscale" /></td><td><input id="sf_8_4" name="sf_8_4" class="inputswotvalscale" /></td><td><input id="sf_8_5" name="sf_8_5" class="inputswotvalscale" /></td><td><input id="sf_8_6" name="sf_8_6" class="inputswotvalscale" /></td><td><input id="sf_st_8" name="sf_st_8" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_8" name="sf_we_8" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_8" name="sf_w_8" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_9" name="sf_b_9" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_9" name="sf_m_9" class="inputmeasure"/></td><td><input id="sf_9_1" name="sf_9_1" class="inputswotvalscale" /></td><td><input id="sf_9_2" name="sf_9_2" class="inputswotvalscale"  /></td><td><input id="sf_9_3" name="sf_9_3" class="inputswotvalscale" /></td><td><input id="sf_9_4" name="sf_9_4" class="inputswotvalscale" /></td><td><input id="sf_9_5" name="sf_9_5" class="inputswotvalscale" /></td><td><input id="sf_9_6" name="sf_9_6" class="inputswotvalscale" /></td><td><input id="sf_st_9" name="sf_st_9" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_9" name="sf_we_9" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_9" name="sf_w_9" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="sf_b_10" name="sf_b_10" class="inputfactor" onkeyup="sf_b_change(this)"/></td><td><input id="sf_m_10" name="sf_m_10" class="inputmeasure"/></td><td><input id="sf_10_1" name="sf_10_1" class="inputswotvalscale" /></td><td><input id="sf_10_2" name="sf_10_2" class="inputswotvalscale"  /></td><td><input id="sf_10_3" name="sf_10_3" class="inputswotvalscale" /></td><td><input id="sf_10_4" name="sf_10_4" class="inputswotvalscale" /></td><td><input id="sf_10_5" name="sf_10_5" class="inputswotvalscale" /></td><td><input id="sf_10_6" name="sf_10_6" class="inputswotvalscale" /></td><td><input id="sf_st_10" name="sf_st_10" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_we_10" name="sf_we_10" class="inputswotval" onkeyup="sfchange(this)" /></td><td><input id="sf_w_10" name="sf_w_10" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><input id="sf_st_sum" name="sf_st_sum" class="inputswotsum" disabled /></td><td><input id="sf_we_sum" name="sf_we_sum" class="inputswotsum" disabled /></td><td><input id="sf_w_sum" name="sf_w_sum" class="inputswotsum" disabled /></td>
  </TR>
  </TABLE>
  <br/>

  <TABLE class="tableswot">
  <TR>
  <td class="tdswot" colspan="11" style="text-align:center"><b>Scale</b></td>
  </TR>
  <TR>
  <td></td><td></td><td colspan="3" style="text-align:center"><b>Opportunity</b></td><td colspan="3" style="text-align:center"><b>Threat</b></td><td><b>Opportunity</b></td><td><b>Threat</b></td><td><b>Weighted</b></td>
  </TR>
  <TR>
  <td style="text-align:center"><b>Environment Factor</b></td><td style="text-align:center"><b>Key Performance Indicator (KPI)</b></td><td style="text-align:center"><b>Low</b></td><td style="text-align:center"><b>Mid</b></td><td style="text-align:center"><b>High</b></td><td style="text-align:center"><b>Low</b></td><td style="text-align:center"><b>Mid</b></td style="text-align:center"><td><b>High</b></td><td><b>1-3</b></td><td><b>1-3</b></td><td><b>factor</b></td>
  </TR>
  <TR>
  <td><input id="se_b_1" name="se_b_1" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_1" name="se_m_1" class="inputmeasure"/></td><td><input id="se_1_1" name="se_1_1" class="inputswotvalscale"  /></td><td><input id="se_1_2" name="se_1_2" class="inputswotvalscale"  /></td><td><input id="se_1_3" name="se_1_3" class="inputswotvalscale"  /></td><td><input id="se_1_4" name="se_1_4" class="inputswotvalscale"  /></td><td><input id="se_1_5" name="se_1_5" class="inputswotvalscale"  /></td><td><input id="se_1_6" name="se_1_6" class="inputswotvalscale"  /></td><td><input id="se_op_1" name="se_op_1" class="inputswotval"  onkeyup="sechange(this)"/></td><td><input id="se_th_1" name="se_th_1" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_1" name="se_w_1" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_2" name="se_b_2" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_2" name="se_m_2" class="inputmeasure"/></td><td><input id="se_2_1" name="se_2_1" class="inputswotvalscale" /></td><td><input id="se_2_2" name="se_2_2" class="inputswotvalscale" /></td><td><input id="se_2_3" name="se_2_3" class="inputswotvalscale" /></td><td><input id="se_2_4" name="se_2_4" class="inputswotvalscale" /></td><td><input id="se_2_5" name="se_2_5" class="inputswotvalscale" /></td><td><input id="se_2_6" name="se_2_6" class="inputswotvalscale" /></td><td><input id="se_op_2" name="se_op_2" class="inputswotval"  onkeyup="sechange(this)"/></td><td><input id="se_th_2" name="se_th_2" class="inputswotval"  onkeyup="sechange(this)"/></td><td><input id="se_w_2" name="se_w_2" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_3" name="se_b_3" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_3" name="se_m_3" class="inputmeasure"/></td><td><input id="se_3_1" name="se_3_1" class="inputswotvalscale" /></td><td><input id="se_3_2" name="se_3_2" class="inputswotvalscale"  /></td><td><input id="se_3_3" name="se_3_3" class="inputswotvalscale" /></td><td><input id="se_3_4" name="se_3_4" class="inputswotvalscale" /></td><td><input id="se_3_5" name="se_3_5" class="inputswotvalscale" /></td><td><input id="se_3_6" name="se_3_6" class="inputswotvalscale" /></td><td><input id="se_op_3" name="se_op_3" class="inputswotval"  onkeyup="sechange(this)"/></td><td><input id="se_th_3" name="se_th_3" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_3" name="se_w_3" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_4" name="se_b_4" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_4" name="se_m_4" class="inputmeasure"/></td><td><input id="se_4_1" name="se_4_1" class="inputswotvalscale" /></td><td><input id="se_4_2" name="se_4_2" class="inputswotvalscale"  /></td><td><input id="se_4_3" name="se_4_3" class="inputswotvalscale" /></td><td><input id="se_4_4" name="se_4_4" class="inputswotvalscale" /></td><td><input id="se_4_5" name="se_4_5" class="inputswotvalscale" /></td><td><input id="se_4_6" name="se_4_6" class="inputswotvalscale" /></td><td><input id="se_op_4" name="se_op_4" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_4" name="se_th_4" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_4" name="se_w_4" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_5" name="se_b_5" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_5" name="se_m_5" class="inputmeasure"/></td><td><input id="se_5_1" name="se_5_1" class="inputswotvalscale" /></td><td><input id="se_5_2" name="se_5_2" class="inputswotvalscale"  /></td><td><input id="se_5_3" name="se_5_3" class="inputswotvalscale" /></td><td><input id="se_5_4" name="se_5_4" class="inputswotvalscale" /></td><td><input id="se_5_5" name="se_5_5" class="inputswotvalscale" /></td><td><input id="se_5_6" name="se_5_6" class="inputswotvalscale" /></td><td><input id="se_op_5" name="se_op_5" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_5" name="se_th_5" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_5" name="se_w_5" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_6" name="se_b_6" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_6" name="se_m_6" class="inputmeasure"/></td><td><input id="se_6_1" name="se_6_1" class="inputswotvalscale" /></td><td><input id="se_6_2" name="se_6_2" class="inputswotvalscale"  /></td><td><input id="se_6_3" name="se_6_3" class="inputswotvalscale" /></td><td><input id="se_6_4" name="se_6_4" class="inputswotvalscale" /></td><td><input id="se_6_5" name="se_6_5" class="inputswotvalscale" /></td><td><input id="se_6_6" name="se_6_6" class="inputswotvalscale" /></td><td><input id="se_op_6" name="se_op_6" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_6" name="se_th_6" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_6" name="se_w_6" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_7" name="se_b_7" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_7" name="se_m_7" class="inputmeasure"/></td><td><input id="se_7_1" name="se_7_1" class="inputswotvalscale" /></td><td><input id="se_7_2" name="se_7_2" class="inputswotvalscale"  /></td><td><input id="se_7_3" name="se_7_3" class="inputswotvalscale" /></td><td><input id="se_7_4" name="se_7_4" class="inputswotvalscale" /></td><td><input id="se_7_5" name="se_7_5" class="inputswotvalscale" /></td><td><input id="se_7_6" name="se_7_6" class="inputswotvalscale" /></td><td><input id="se_op_7" name="se_op_7" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_7" name="se_th_7" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_7" name="se_w_7" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_8" name="se_b_8" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_8" name="se_m_8" class="inputmeasure"/></td><td><input id="se_8_1" name="se_8_1" class="inputswotvalscale" /></td><td><input id="se_8_2" name="se_8_2" class="inputswotvalscale"  /></td><td><input id="se_8_3" name="se_8_3" class="inputswotvalscale" /></td><td><input id="se_8_4" name="se_8_4" class="inputswotvalscale" /></td><td><input id="se_8_5" name="se_8_5" class="inputswotvalscale" /></td><td><input id="se_8_6" name="se_8_6" class="inputswotvalscale" /></td><td><input id="se_op_8" name="se_op_8" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_8" name="se_th_8" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_8" name="se_w_8" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_9" name="se_b_9" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_9" name="se_m_9" class="inputmeasure"/></td><td><input id="se_9_1" name="se_9_1" class="inputswotvalscale" /></td><td><input id="se_9_2" name="se_9_2" class="inputswotvalscale"  /></td><td><input id="se_9_3" name="se_9_3" class="inputswotvalscale" /></td><td><input id="se_9_4" name="se_9_4" class="inputswotvalscale" /></td><td><input id="se_9_5" name="se_9_5" class="inputswotvalscale" /></td><td><input id="se_9_6" name="se_9_6" class="inputswotvalscale" /></td><td><input id="se_op_9" name="se_op_9" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_9" name="se_th_9" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_9" name="se_w_9" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td><input id="se_b_10" name="se_b_10" class="inputfactor" onkeyup="se_b_change(this)"/></td><td><input id="se_m_10" name="se_m_10" class="inputmeasure"/></td><td><input id="se_10_1" name="se_10_1" class="inputswotvalscale" /></td><td><input id="se_10_2" name="se_10_2" class="inputswotvalscale"  /></td><td><input id="se_10_3" name="se_10_3" class="inputswotvalscale" /></td><td><input id="se_10_4" name="se_10_4" class="inputswotvalscale" /></td><td><input id="se_10_5" name="se_10_5" class="inputswotvalscale" /></td><td><input id="se_10_6" name="se_10_6" class="inputswotvalscale" /></td><td><input id="se_op_10" name="se_op_10" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_th_10" name="se_th_10" class="inputswotval" onkeyup="sechange(this)" /></td><td><input id="se_w_10" name="se_w_10" class="inputswotweighted" disabled /></td>
  </TR>
  <TR>
  <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><input id="se_op_sum" name="se_op_sum" class="inputswotsum" disabled /></td><td><input id="se_th_sum" name="se_th_sum" class="inputswotsum" disabled /></td><td><input id="se_w_sum" name="se_w_sum" class="inputswotsum" disabled /></td>
  </TR>
  </TABLE>
</div>

<div id="weighted" class="tabcontent">

  <TABLE class="">
  <TR>
  <td><b>Internal Factor</b></td><td><input id="wif_name_1" name="wif_name_1" class="inputwifname" /></td><td><input id="wif_name_2" name="wif_name_2" class="inputwifname" /></td><td><input id="wif_name_3" name="wif_name_3" class="inputwifname"  /></td><td><input id="wif_name_4" name="wif_name_4" class="inputwifname"  /></td><td><input id="wif_name_5" name="wif_name_5" class="inputwifname"  /></td><td><input id="wif_name_6" name="wif_name_6" class="inputwifname" /></td><td><input id="wif_name_7" name="wif_name_7" class="inputwifname"  /></td><td><input id="wif_name_8" name="wif_name_8" class="inputwifname"  /></td><td><input id="wif_name_9" name="wif_name_9" class="inputwifname" /></td><td><input id="wif_name_10" name="wif_name_10" class="inputwifname"/></td><td><b>Average</b></td><td><b>SD</b></td><td><b>SD/Average</b></td>
  </TR>
  <td><input id="wif_b_1" name="wif_b_1" class="inputfactor" disabled /></td><td><input id="wif_1_1" name="wif_1_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_2" name="wif_1_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_3" name="wif_1_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_4" name="wif_1_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_5" name="wif_1_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_6" name="wif_1_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_7" name="wif_1_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_8" name="wif_1_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_9" name="wif_1_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_10" name="wif_1_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_1_avg" name="wif_1_avg" class="inputwifval" disabled /></td><td><input id="wif_1_sd" name="wif_1_sd" class="inputwifval" disabled /></td><td><input id="wif_1_sdavg" name="wif_1_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_2" name="wif_b_2" class="inputfactor" disabled /></td><td><input id="wif_2_1" name="wif_2_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_2" name="wif_2_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_3" name="wif_2_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_4" name="wif_2_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_5" name="wif_2_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_6" name="wif_2_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_7" name="wif_2_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_8" name="wif_2_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_9" name="wif_2_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_10" name="wif_2_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_2_avg" name="wif_2_avg" class="inputwifval" disabled /></td><td><input id="wif_2_sd" name="wif_2_sd" class="inputwifval" disabled /></td><td><input id="wif_2_sdavg" name="wif_2_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_3" name="wif_b_3" class="inputfactor" disabled /></td><td><input id="wif_3_1" name="wif_3_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_2" name="wif_3_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_3" name="wif_3_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_4" name="wif_3_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_5" name="wif_3_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_6" name="wif_3_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_7" name="wif_3_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_8" name="wif_3_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_9" name="wif_3_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_10" name="wif_3_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_3_avg" name="wif_3_avg" class="inputwifval" disabled /></td><td><input id="wif_3_sd" name="wif_3_sd" class="inputwifval" disabled /></td><td><input id="wif_3_sdavg" name="wif_3_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_4" name="wif_b_4" class="inputfactor" disabled /></td><td><input id="wif_4_1" name="wif_4_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_2" name="wif_4_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_3" name="wif_4_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_4" name="wif_4_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_5" name="wif_4_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_6" name="wif_4_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_7" name="wif_4_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_8" name="wif_4_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_9" name="wif_4_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_10" name="wif_4_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_4_avg" name="wif_4_avg" class="inputwifval" disabled /></td><td><input id="wif_4_sd" name="wif_4_sd" class="inputwifval" disabled /></td><td><input id="wif_4_sdavg" name="wif_4_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_5" name="wif_b_5" class="inputfactor" disabled /></td><td><input id="wif_5_1" name="wif_5_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_2" name="wif_5_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_3" name="wif_5_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_4" name="wif_5_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_5" name="wif_5_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_6" name="wif_5_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_7" name="wif_5_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_8" name="wif_5_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_9" name="wif_5_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_10" name="wif_5_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_5_avg" name="wif_5_avg" class="inputwifval" disabled /></td><td><input id="wif_5_sd" name="wif_5_sd" class="inputwifval" disabled /></td><td><input id="wif_5_sdavg" name="wif_5_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_6" name="wif_b_6" class="inputfactor" disabled /></td><td><input id="wif_6_1" name="wif_6_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_2" name="wif_6_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_3" name="wif_6_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_4" name="wif_6_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_5" name="wif_6_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_6" name="wif_6_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_7" name="wif_6_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_8" name="wif_6_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_9" name="wif_6_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_10" name="wif_6_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_6_avg" name="wif_6_avg" class="inputwifval" disabled /></td><td><input id="wif_6_sd" name="wif_6_sd" class="inputwifval" disabled /></td><td><input id="wif_6_sdavg" name="wif_6_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_7" name="wif_b_7" class="inputfactor" disabled /></td><td><input id="wif_7_1" name="wif_7_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_2" name="wif_7_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_3" name="wif_7_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_4" name="wif_7_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_5" name="wif_7_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_6" name="wif_7_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_7" name="wif_7_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_8" name="wif_7_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_9" name="wif_7_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_10" name="wif_7_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_7_avg" name="wif_7_avg" class="inputwifval" disabled /></td><td><input id="wif_7_sd" name="wif_7_sd" class="inputwifval" disabled /></td><td><input id="wif_7_sdavg" name="wif_7_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_8" name="wif_b_8" class="inputfactor" disabled /></td><td><input id="wif_8_1" name="wif_8_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_2" name="wif_8_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_3" name="wif_8_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_4" name="wif_8_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_5" name="wif_8_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_6" name="wif_8_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_7" name="wif_8_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_8" name="wif_8_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_9" name="wif_8_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_10" name="wif_8_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_8_avg" name="wif_8_avg" class="inputwifval" disabled /></td><td><input id="wif_8_sd" name="wif_8_sd" class="inputwifval" disabled /></td><td><input id="wif_8_sdavg" name="wif_8_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_9" name="wif_b_9" class="inputfactor" disabled /></td><td><input id="wif_9_1" name="wif_9_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_2" name="wif_9_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_3" name="wif_9_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_4" name="wif_9_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_5" name="wif_9_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_6" name="wif_9_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_7" name="wif_9_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_8" name="wif_9_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_9" name="wif_9_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_10" name="wif_9_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_9_avg" name="wif_9_avg" class="inputwifval" disabled /></td><td><input id="wif_9_sd" name="wif_9_sd" class="inputwifval" disabled /></td><td><input id="wif_9_sdavg" name="wif_9_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wif_b_10" name="wif_b_10" class="inputfactor" disabled /></td><td><input id="wif_10_1" name="wif_10_1" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_2" name="wif_10_2" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_3" name="wif_10_3" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_4" name="wif_10_4" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_5" name="wif_10_5" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_6" name="wif_10_6" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_7" name="wif_10_7" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_8" name="wif_10_8" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_9" name="wif_10_9" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_10" name="wif_10_10" class="inputwifval" onkeyup="wifchange(this)" /></td><td><input id="wif_10_avg" name="wif_10_avg" class="inputwifval" disabled /></td><td><input id="wif_10_sd" name="wif_10_sd" class="inputwifval" disabled /></td><td><input id="wif_10_sdavg" name="wif_10_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><b>TOTAL</b></td><td><input id="wif_total_1" name="wif_total_1" class="inputwiftotal" disabled /></td><td><input id="wif_total_2" name="wif_total_2" class="inputwiftotal" disabled /></td><td><input id="wif_total_3" name="wif_total_3" class="inputwiftotal" disabled /></td><td><input id="wif_total_4" name="wif_total_4" class="inputwiftotal" disabled /></td><td><input id="wif_total_5" name="wif_total_5" class="inputwiftotal" disabled /></td><td><input id="wif_total_6" name="wif_total_6" class="inputwiftotal" disabled /></td><td><input id="wif_total_7" name="wif_total_7" class="inputwiftotal" disabled /></td><td><input id="wif_total_8" name="wif_total_8" class="inputwiftotal" disabled /></td><td><input id="wif_total_9" name="wif_total_9" class="inputwiftotal" disabled /></td><td><input id="wif_total_10" name="wif_total_10" class="inputwiftotal" disabled /></td><td><input id="wif_total_avg" name="wif_total_avg" class="inputwiftotal" disabled /></td><td></td><td></td><td></td>
  </TR>
  </TABLE>
<br>
  <TABLE class="">
  <TR>
  <td><b>External Factor</b></td><td><input id="wef_name_1" name="wef_name_1" class="inputwifname" /></td><td><input id="wef_name_2" name="wef_name_2" class="inputwifname" /></td><td><input id="wef_name_3" name="wef_name_3" class="inputwifname"  /></td><td><input id="wef_name_4" name="wef_name_4" class="inputwifname"  /></td><td><input id="wef_name_5" name="wef_name_5" class="inputwifname"  /></td><td><input id="wef_name_6" name="wef_name_6" class="inputwifname" /></td><td><input id="wef_name_7" name="wef_name_7" class="inputwifname"  /></td><td><input id="wef_name_8" name="wef_name_8" class="inputwifname"  /></td><td><input id="wef_name_9" name="wef_name_9" class="inputwifname" /></td><td><input id="wef_name_10" name="wef_name_10" class="inputwifname"/></td><td><b>Average</b></td><td><b>SD</b></td><td><b>SD/Average</b></td>
  </TR>
  <td><input id="wef_b_1" name="wef_b_1" class="inputfactor" disabled /></td><td><input id="wef_1_1" name="wef_1_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_2" name="wef_1_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_3" name="wef_1_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_4" name="wef_1_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_5" name="wef_1_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_6" name="wef_1_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_7" name="wef_1_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_8" name="wef_1_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_9" name="wef_1_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_10" name="wef_1_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_1_avg" name="wef_1_avg" class="inputwifval" disabled /></td><td><input id="wef_1_sd" name="wef_1_sd" class="inputwifval" disabled /></td><td><input id="wef_1_sdavg" name="wef_1_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_2" name="wef_b_2" class="inputfactor" disabled /></td><td><input id="wef_2_1" name="wef_2_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_2" name="wef_2_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_3" name="wef_2_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_4" name="wef_2_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_5" name="wef_2_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_6" name="wef_2_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_7" name="wef_2_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_8" name="wef_2_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_9" name="wef_2_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_10" name="wef_2_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_2_avg" name="wef_2_avg" class="inputwifval" disabled /></td><td><input id="wef_2_sd" name="wef_2_sd" class="inputwifval" disabled /></td><td><input id="wef_2_sdavg" name="wef_2_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_3" name="wef_b_3" class="inputfactor" disabled /></td><td><input id="wef_3_1" name="wef_3_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_2" name="wef_3_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_3" name="wef_3_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_4" name="wef_3_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_5" name="wef_3_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_6" name="wef_3_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_7" name="wef_3_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_8" name="wef_3_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_9" name="wef_3_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_10" name="wef_3_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_3_avg" name="wef_3_avg" class="inputwifval" disabled /></td><td><input id="wef_3_sd" name="wef_3_sd" class="inputwifval" disabled /></td><td><input id="wef_3_sdavg" name="wef_3_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_4" name="wef_b_4" class="inputfactor" disabled /></td><td><input id="wef_4_1" name="wef_4_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_2" name="wef_4_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_3" name="wef_4_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_4" name="wef_4_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_5" name="wef_4_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_6" name="wef_4_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_7" name="wef_4_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_8" name="wef_4_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_9" name="wef_4_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_10" name="wef_4_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_4_avg" name="wef_4_avg" class="inputwifval" disabled /></td><td><input id="wef_4_sd" name="wef_4_sd" class="inputwifval" disabled /></td><td><input id="wef_4_sdavg" name="wef_4_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_5" name="wef_b_5" class="inputfactor" disabled /></td><td><input id="wef_5_1" name="wef_5_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_2" name="wef_5_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_3" name="wef_5_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_4" name="wef_5_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_5" name="wef_5_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_6" name="wef_5_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_7" name="wef_5_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_8" name="wef_5_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_9" name="wef_5_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_10" name="wef_5_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_5_avg" name="wef_5_avg" class="inputwifval" disabled /></td><td><input id="wef_5_sd" name="wef_5_sd" class="inputwifval" disabled /></td><td><input id="wef_5_sdavg" name="wef_5_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_6" name="wef_b_6" class="inputfactor" disabled /></td><td><input id="wef_6_1" name="wef_6_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_2" name="wef_6_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_3" name="wef_6_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_4" name="wef_6_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_5" name="wef_6_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_6" name="wef_6_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_7" name="wef_6_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_8" name="wef_6_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_9" name="wef_6_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_10" name="wef_6_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_6_avg" name="wef_6_avg" class="inputwifval" disabled /></td><td><input id="wef_6_sd" name="wef_6_sd" class="inputwifval" disabled /></td><td><input id="wef_6_sdavg" name="wef_6_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_7" name="wef_b_7" class="inputfactor" disabled /></td><td><input id="wef_7_1" name="wef_7_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_2" name="wef_7_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_3" name="wef_7_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_4" name="wef_7_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_5" name="wef_7_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_6" name="wef_7_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_7" name="wef_7_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_8" name="wef_7_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_9" name="wef_7_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_10" name="wef_7_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_7_avg" name="wef_7_avg" class="inputwifval" disabled /></td><td><input id="wef_7_sd" name="wef_7_sd" class="inputwifval" disabled /></td><td><input id="wef_7_sdavg" name="wef_7_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_8" name="wef_b_8" class="inputfactor" disabled /></td><td><input id="wef_8_1" name="wef_8_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_2" name="wef_8_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_3" name="wef_8_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_4" name="wef_8_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_5" name="wef_8_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_6" name="wef_8_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_7" name="wef_8_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_8" name="wef_8_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_9" name="wef_8_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_10" name="wef_8_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_8_avg" name="wef_8_avg" class="inputwifval" disabled /></td><td><input id="wef_8_sd" name="wef_8_sd" class="inputwifval" disabled /></td><td><input id="wef_8_sdavg" name="wef_8_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_9" name="wef_b_9" class="inputfactor" disabled /></td><td><input id="wef_9_1" name="wef_9_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_2" name="wef_9_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_3" name="wef_9_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_4" name="wef_9_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_5" name="wef_9_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_6" name="wef_9_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_7" name="wef_9_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_8" name="wef_9_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_9" name="wef_9_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_10" name="wef_9_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_9_avg" name="wef_9_avg" class="inputwifval" disabled /></td><td><input id="wef_9_sd" name="wef_9_sd" class="inputwifval" disabled /></td><td><input id="wef_9_sdavg" name="wef_9_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><input id="wef_b_10" name="wef_b_10" class="inputfactor" disabled /></td><td><input id="wef_10_1" name="wef_10_1" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_2" name="wef_10_2" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_3" name="wef_10_3" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_4" name="wef_10_4" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_5" name="wef_10_5" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_6" name="wef_10_6" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_7" name="wef_10_7" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_8" name="wef_10_8" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_9" name="wef_10_9" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_10" name="wef_10_10" class="inputwifval" onkeyup="wefchange(this)" /></td><td><input id="wef_10_avg" name="wef_10_avg" class="inputwifval" disabled /></td><td><input id="wef_10_sd" name="wef_10_sd" class="inputwifval" disabled /></td><td><input id="wef_10_sdavg" name="wef_10_sdavg" class="inputwifval" disabled /></td>
  </TR>
  <TR>
  <td><b>TOTAL</b></td><td><input id="wef_total_1" name="wef_total_1" class="inputwiftotal" disabled /></td><td><input id="wef_total_2" name="wef_total_2" class="inputwiftotal" disabled /></td><td><input id="wef_total_3" name="wef_total_3" class="inputwiftotal" disabled /></td><td><input id="wef_total_4" name="wef_total_4" class="inputwiftotal" disabled /></td><td><input id="wef_total_5" name="wef_total_5" class="inputwiftotal" disabled /></td><td><input id="wef_total_6" name="wef_total_6" class="inputwiftotal" disabled /></td><td><input id="wef_total_7" name="wef_total_7" class="inputwiftotal" disabled /></td><td><input id="wef_total_8" name="wef_total_8" class="inputwiftotal" disabled /></td><td><input id="wef_total_9" name="wef_total_9" class="inputwiftotal" disabled /></td><td><input id="wef_total_10" name="wef_total_10" class="inputwiftotal" disabled /></td><td><input id="wef_total_avg" name="wef_total_avg" class="inputwiftotal" disabled /></td><td></td><td></td><td></td>
  </TR>
  </TABLE>

</div>

<div id="analysis" class="tabcontent">
  <table><tr>
<TD>
<h1> Summary</h1>
<table style="text-align: center">
<tr>
<td><b>S</b></td><td><b>T</b></td><td><b>W</b></td><td><b>O</b></td>
</tr>
<tr>
<td><input id="an_1" name="an_1" class="inputswotval" disabled/></td><td><input id="an_2" name="an_2" class="inputswotval" disabled/></td><td><input id="an_3" name="an_3" class="inputswotval" disabled/></td><td><input id="an_4" name="an_4" class="inputswotval" disabled/></td>
</tr>
</table>
<table>
<tr>
<td><b>Firm Vector</b></td><td><input id="an_fv" name="an_fv" class="inputswotanalysis" disabled/></td>
</tr>
<tr>
<td><b>Environment Vector</b></td><td><input id="an_ev" name="an_ev" class="inputswotanalysis" disabled/></td>
</tr>
<tr>
<td><b>Leading Strategy</b></td><td><input id="an_ls" name="an_ls" class="inputswotleadingstrategy" disabled/></td>
</tr>
</table>
</td>
<td>

<div id="chart-container"><canvas id="mChart" width="100" height="100" style="background-image: url(canvasclock.png);"></canvas></div>
<script>

var ctx = document.getElementById('mChart');
var myChart = new Chart(ctx, {
    type: 'radar',
    data: {
        datasets: [{
            label: '',
            data: [0, 0, 0, 0]
        }],
        labels: ['S', 'T', 'W', 'O']
    },
    options: {
        scale: {
            ticks: {
                suggestedMin: 50,
                suggestedMax: 100
            }
        }
    }
});
myChart.canvas.parentNode.style.height = '250px';
myChart.canvas.parentNode.style.width = '250px';

</script>
</TD>
</tr></table>
</div>
</form>
<span id="img_link" img_link="{% static 'img' %}"></span>

<script>

var link_save_data = '{% url "swotclock:save_data" %}';
var link_get_data = '{% url "swotclock:get_data" %}';
var link_get_user_swot = '{% url "swotclock:get_user_swot" %}';
var link_delete_data = '{% url "swotclock:delete_data" %}';

function filescomboboxchange(){
  var file = $( "#filescombobox" ).val();
  //alert(file)
  get_data(swot_clock_id=file)
}

function resetForm(){
    //Clear form
    document.getElementById("swotform").reset();
    $('#filescombobox').val('---Select---');
}

var delete_data = function()
{
  var swot_clock_id = $( "#filescombobox" ).val();
  // alert(swot_clock_id)

   var ss = prompt('Are you sure, you want to delete this file? if so, type yes.', 'no')
   if (ss == 'yes')
   {
      $.post(link_delete_data,
      {
        swot_clock_id: swot_clock_id
      },
      function(data){
          alert(data['status']);
          get_user_swot();
          resetForm();
      })
   }
}

var get_user_swot = function()
{
  $.post(link_get_user_swot,
  {
  },
  function(data){
      var o_elm = document.getElementById("filescombobox")
      o_elm.options.length = 0;
       var option_ = document.createElement("option");
       option_.setAttribute("value", "---Select---") ;
       option_.innerHTML = "--- Select file ---";
       o_elm.append(option_);

      for(var k in data)
      {
       option_ = document.createElement("option");
       option_.setAttribute("id", "option_" + k) ;
       option_.setAttribute("value", k) ;
       option_.innerHTML = data[k];
       o_elm.append(option_);
      }
  })
}

function get_data(swot_clock_id='1')
{
  $.post(link_get_data,
  {
    swot_clock_id: swot_clock_id
  },
  function(data){
      document.getElementById("swotform").reset();
      // alert(data)
      for(var k in data)
      {
       document.getElementById(k).value = data[k]
       //alert(k + ": " + data[k])
      }

     var event_btn_dimond = new Event("click", {bubbles: true});
     var elm_btn_dimond = document.getElementById("btn_dimond");
     elm_btn_dimond.dispatchEvent(event_btn_dimond)

     for(var i=1; i<11; i++)
     {
       var r = "sf_b_" + i ;
       var er = "se_b_" + i ;

       var event_r = new Event("keyup", {bubbles: true});
       var event_er = new Event("keyup", {bubbles: true});
       var elm_r = document.getElementById(r);
       var elm_er = document.getElementById(er);
       elm_r.dispatchEvent(event_r)
       elm_er.dispatchEvent(event_er)
     }
     calculateForm()
  })
}

decode_special_chars = function(s)
{
 s = s.replaceAll("%20", " ").replaceAll("%26", "&").replaceAll("%2C", ",").replaceAll("%24", "$")
 s = s.replaceAll("%23", "#").replaceAll("%2F", "/").replaceAll("%25", "%");
 return s;
}

function save_data(is_new='1')
{
  calculateForm()
  var file_name = '';
  var swot_clock_id = -1;
  if(is_new == '1')
  {
    file_name = prompt('Enter  file name:', '')
    if(file_name == "" || file_name == null){return;}
  } else
  {
    swot_clock_id = $( "#filescombobox" ).val();
  }
  var obj = {};
  data = $("#swotform").serialize(); //.serializeArray()
  var data_ = data.split("&")
  for (k in data_)
  {
    z = data_[k].split("=");
    if(z[1] != '')
    {obj[z[0]] = decode_special_chars(z[1]);
    // alert('obj[z[0]]  ' + obj[z[0]]);
    }
  }

  $.post(link_save_data,
  {
    is_new: is_new,
    file_name: file_name,
    swot_clock_id: swot_clock_id,
    data: JSON.stringify(obj)
  },
  function(data){
      alert(data['status'])
  })
}


function openTab(event) {
  let elm = event.target;
  let tab_name = elm.getAttribute("tab_type");
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tab_name).style.display = "block";
  elm.className += " active";
}


function newChart(s,t,w,o,ls){

  $('#mChart').remove(); // this is my <canvas> element
  var img = document.getElementById("img_link").getAttribute("img_link")+"/"+"canvasclock" + ls + ".png";
  //var img_ = document.getElementById("img_link").getAttribute("img_link")+"/"+img;
  //alert(img_)
  var canvas = '<canvas id="mChart" width="100" height="100" style="background-image: url(' + img + ');">'
  $('#chart-container').append(canvas);

  var ctx = document.getElementById('mChart');
  var myChart = new Chart(ctx, {
      type: 'radar',
      data: {
          datasets: [{
              label: '',
              data: [s, t, w, o]
          }],
          labels: ['S', 'T', 'W', 'O']
      },
      options: {
          scale: {
              ticks: {
                  suggestedMin: 50,
                  suggestedMax: 100
              }
          }
      }
  });
  myChart.canvas.parentNode.style.height = '250px';
  myChart.canvas.parentNode.style.width = '250px';

//   ctx = canvas.getContext('2d');
//   ctx.canvas.width = $('#graph').width(); // resize to parent width
//   ctx.canvas.height = $('#graph').height(); // resize to parent height
}



function calculateForm(){

  //WIF rows
  for (row=1; row<11; row++) {
    //calculate average, SD, and SD/average
    arr = new Array();
    for (i=1; i<11; i++){
      //get cell value
      cid = "wif_" + row + "_" + i;
      val = document.getElementById(cid).value
      if (val.length > 0 ){arr.push(val);}
    }
    if (Array.isArray(arr) && arr.length){
      var avgid = "wif_" + row + "_avg";
      var avg = math.mean(arr).toFixed(2);
      document.getElementById(avgid).value = avg;

      var sdid = "wif_" + row + "_sd";
      var std = math.std(arr).toFixed(2);
      document.getElementById(sdid).value = std;

      var sdid = "wif_" + row + "_sdavg";
      document.getElementById(sdid).value = (std/avg).toFixed(2);
    }
  }

  //WEF columns
  wiftotalcol(0);

  //WEF rows
  for (row=1; row<11; row++){
      //calculate average, SD, and SD/average
      arr = new Array();
      for (i=1; i<11; i++){
        //get cell value
        cid = "wef_" + row + "_" + i;
        val = document.getElementById(cid).value
        if (val.length > 0 ){arr.push(val);}
      }
      if (Array.isArray(arr) && arr.length){
        var avgid = "wef_" + row + "_avg";
        var avg = math.mean(arr).toFixed(2);
        document.getElementById(avgid).value = avg;

        var sdid = "wef_" + row + "_sd";
        var std = math.std(arr).toFixed(2);
        document.getElementById(sdid).value = std;

        var sdid = "wef_" + row + "_sdavg";
        document.getElementById(sdid).value = (std/avg).toFixed(2);
      }

  }

  //WEF columns
  weftotalcol(0); //Calculate columns

  //SF + SE rows weighted factors
  var elmsf = "";
  var elmwi = "";
  var elmse = "";
  var elmwe = "";
  for (row=1; row<11; row++){
    elmsf = "sf_w_" + row;
    elmwi = "wif_" + row + "_avg";
    elmse = "se_w_" + row;
    elmwe = "wef_" + row + "_avg";
    document.getElementById(elmsf).value = document.getElementById(elmwi).value;
    document.getElementById(elmse).value = document.getElementById(elmwe).value;
  }
  sfsumweighted(0);
  sesumweighted(0);

  //SF  columns
  sftotalcol(0);

  //SE  columns
  setotalcol(0);

  //Analyse SWOT CLOCK
  analyseswot();
}

function sf_b_change(evt){
  var id = evt.id;
  var val = evt.value;
  //get row
  var res = id.split("_");
  var row = res[1];
  var col = res[2];

  wfid = "wif_b_" + col;
  document.getElementById(wfid).value = val;

  //Analyse SWOT CLOCK
  analyseswot();
}

function sfchange(evt){
  var id = evt.id;
//   var val = evt.value.replace(/\D/g,'');  //remove non numeric
  var val = evt.value.replace(/[^0-9.]/g, '');

  //get row
  var res = id.split("_");
  var row = res[1];
  var col = res[2];

  //check input
  //is numeric between 1 and 3
  if (val<1 || val>3){
    document.getElementById(id).value = "";
  }

  //Update column total
  sftotalcol()

  //Analyse SWOT CLOCK
  analyseswot();
}

function sfsumweighted(analyse = 1){

  var sum = 0;
  var id = "";
  var arr = new Array();
  var val = 0;
  for (i = 1; i < 11; i++){
    id = "sf_w_" + i;
    val = document.getElementById(id).value;
    arr.push(val);
  }

  document.getElementById("sf_w_sum").value = math.sum(arr).toFixed(2);

  //Analyse SWOT CLOCK
  if (analyse == 1) {analyseswot();}
}

function sftotalcol(analyse = 1){

  var id = "";
  var arrST = new Array();
  var arrWE = new Array();
  var valst = 0;
  var valwe = 0;
  var valfactor = 0;
  var val = 0;

  for (i = 1; i < 11; i++){ //loop rows

    factor = "sf_w_" + i;
    valfactor = document.getElementById(factor).value;

    //Strength
    st = "sf_st_" + i;
    valst = document.getElementById(st).value;
    val = valfactor*valst;
    arrST.push(val);

    //Weakness
    we = "sf_we_" + i;
    valwe = document.getElementById(we).value;
    val = valfactor*valwe;
    arrWE.push(val);
  }

  if (Array.isArray(arrST) && arrST.length){
    document.getElementById("sf_st_sum").value = math.sum(arrST).toFixed(2);
  }
  if (Array.isArray(arrWE) && arrWE.length){
    document.getElementById("sf_we_sum").value = math.sum(arrWE).toFixed(2);
  }

  //Analyse SWOT CLOCK
  if (analyse == 1) {analyseswot();}
}

function se_b_change(evt){
  var id = evt.id;
  var val = evt.value;
  //get row
  var res = id.split("_");
  var row = res[1];
  var col = res[2];

  wfid = "wef_b_" + col;
  document.getElementById(wfid).value = val;

  //Analyse SWOT CLOCK
  analyseswot();
}

function sechange(evt){
  var id = evt.id;
//   var val = evt.value.replace(/\D/g,'');  //remove non numeric
  var val = evt.value.replace(/[^0-9.]/g, '');

  //get row
  var res = id.split("_");
  var row = res[1];
  var col = res[2];

  //check input
  //is numeric between 1 and 3
//   if (val != 1 && val != 2  && val != 3){
  if (val<1 || val>3){
    document.getElementById(id).value = "";
  }

    //Update column total
    setotalcol();

  //Analyse SWOT CLOCK
  analyseswot();
}

function setotalcol(analyse = 1){

  var id = "";
  var arrOP = new Array();
  var arrTH = new Array();
  var val1 = 0;
  var val2 = 0;
  var val3 = 0;

  for (i = 1; i < 11; i++){ //loop rows
    //Strength
    id1 = "se_w_" + i;
    val1 = document.getElementById(id1).value;
    id2 = "se_op_" + i;
    val2 = document.getElementById(id2).value;
    val3 = val1*val2;
    arrOP.push(val3);

    //Weakness
    id2 = "se_th_" + i;
    val2 = document.getElementById(id2).value;
    val3 = val1*val2;
    arrTH.push(val3);
  }

  if (Array.isArray(arrOP) && arrOP.length){
    document.getElementById("se_op_sum").value = math.sum(arrOP).toFixed(2);
  }
  if (Array.isArray(arrTH) && arrTH.length){
    document.getElementById("se_th_sum").value = math.sum(arrTH).toFixed(2);
  }

  //Analyse SWOT CLOCK
  if (analyse == 1) {analyseswot();}
}

function wifchange(evt){
  var id = evt.id;
  var val = evt.value;

  var res = id.split("_");
  var row = res[1];
  var col = res[2];

  var newval = val.replace(/\D/g,''); //remove non numeric
  document.getElementById(id).value = newval;

  //update ROW//
  //calculate average, SD, and SD/average
  arr = new Array();
  for (i=1; i<11; i++){
    //get cell value
    cid = "wif_" + row + "_" + i;
    val = document.getElementById(cid).value
    if (val.length > 0 ){arr.push(val);}
  }

  if (Array.isArray(arr) && arr.length){
    var avgid = "wif_" + row + "_avg";
    var avg = math.mean(arr).toFixed(2);
    document.getElementById(avgid).value = avg;

    var sdid = "wif_" + row + "_sd";
    var std = math.std(arr).toFixed(2);
    document.getElementById(sdid).value = std;

    var sdid = "wif_" + row + "_sdavg";
    document.getElementById(sdid).value = (std/avg).toFixed(2);
  }


  //Update TOTAL//
  wiftotalcol();

  //update SWOT DIMOND Weighted
  var sfwid = "sf_w_" + row;
  document.getElementById(sfwid).value = parseFloat(avg).toFixed(2);
  sfsumweighted(); //weighted factor

  for (col=1 ;col<7; col++){ //Update each column
    sftotalcol(col)
  }
  //Analyse SWOT CLOCK
  analyseswot();
}

function wiftotalcol(analyse = 1){
  var cellid ="";
  var val = "";
  var arr = new Array();
  for (row=1 ;row<11; row++){ //Update each column
    for (col=1 ;col<11; col++){ //Update each column
      cellid = "wif_" + col + "_" + row;
      val = document.getElementById(cellid).value
      if (val.length > 0 ){arr.push(val);}
    }
    cellid = "wif_total_" + row;
    val = math.sum(arr).toFixed(0);
    document.getElementById(cellid).value = val;
    if (val !=100){document.getElementById(cellid).style.color = 'red';} else {document.getElementById(cellid).style.color = 'blue';}
    arr =[];
  }

  //Update average total
  arr = [];
  for (i=1 ; i<11; i++){
    cellid = "wif_" + i + "_avg";
    val = document.getElementById(cellid).value;
    if (val.length > 0 ){arr.push(val);}
  }
  if (Array.isArray(arr) && arr.length){
    var sum = math.sum(arr).toFixed(2);
    document.getElementById("wif_total_avg").value = sum;
  }


  //Analyse SWOT CLOCK
  if (analyse == 1) {analyseswot();}
}

function wefchange(evt){
  var id = evt.id;
  var val = evt.value;

  var res = id.split("_");
  var row = res[1];
  var col = res[2];

  var newval = val.replace(/\D/g,''); //remove non numeric
  document.getElementById(id).value = newval;

  //update ROW//
  //calculate average, SD, and SD/average
  arr = new Array();
  for (i=1; i<11; i++){
    //get cell value
    cid = "wef_" + row + "_" + i;
    val = document.getElementById(cid).value
    if (val.length > 0 ){arr.push(val);}
  }

  if (Array.isArray(arr) && arr.length){
    var avgid = "wef_" + row + "_avg";
    var avg = math.mean(arr).toFixed(2);
    document.getElementById(avgid).value = avg;

    var sdid = "wef_" + row + "_sd";
    var std = math.std(arr).toFixed(2);
    document.getElementById(sdid).value = std;

    var sdid = "wef_" + row + "_sdavg";
    document.getElementById(sdid).value = (std/avg).toFixed(2);
  }


  //Update TOTAL//
  weftotalcol();

  //update SWOT DIMOND Weighted
  var sfwid = "se_w_" + row;
  document.getElementById(sfwid).value = parseFloat(avg).toFixed(2);
  sesumweighted(); //weighted factor

  for (col=1 ;col<7; col++){ //Update each column
    setotalcol(col)
  }

  //Analyse SWOT CLOCK
  analyseswot();
}

function weftotalcol(analyse = 1){
  var cellid ="";
  var val = "";
  var arr = new Array();
  for (row=1 ;row<11; row++){ //Update each column
    for (col=1 ;col<11; col++){ //Update each column
      cellid = "wef_" + col + "_" + row;
      val = document.getElementById(cellid).value;
      if (val.length > 0 ){arr.push(val);}
    }

    cellid = "wef_total_" + row;
    val = math.sum(arr).toFixed(0);
    document.getElementById(cellid).value = val;
    if (val !=100){document.getElementById(cellid).style.color = 'red';} else {document.getElementById(cellid).style.color = 'blue';}
    arr =[];
  }

  //Update average total
  arr = [];
  for (i=1;i<11;i++){
    cellid = "wef_" + i + "_avg";
    val = document.getElementById(cellid).value;
    if (val.length > 0 ){arr.push(val);}
  }
  if (Array.isArray(arr) && arr.length){
    var sum = math.sum(arr).toFixed(2);
    document.getElementById("wef_total_avg").value = sum;
  }


  //Analyse SWOT CLOCK
  if (analyse == 1) {analyseswot();}
}

function sesumweighted(analyse = 1){

  var sum = 0;
  var id = "";
  var arr = new Array();
  var val = 0;
  for (i = 1; i < 11; i++){
    id = "se_w_" + i;
    val = document.getElementById(id).value;
    arr.push(val);
  }

  if (Array.isArray(arr) && arr.length){
    document.getElementById("se_w_sum").value = math.sum(arr).toFixed(2);
  }


  //Analyse SWOT CLOCK
  if (analyse == 1) {analyseswot();}
}

function analyseswot(){

  //calculate S,T,W,O
  //S = sum (sf_sum_1-3)
  var s = parseFloat(document.getElementById("sf_st_sum").value);
  document.getElementById("an_1").value = s.toFixed(2);
  //T = sum (se_sum_4-6)
  var t = parseFloat(document.getElementById("se_th_sum").value);
  document.getElementById("an_2").value = t.toFixed(2);
  //W = sum (sf_sum_4-6)
  var w = parseFloat(document.getElementById("sf_we_sum").value);
  document.getElementById("an_3").value = w.toFixed(2);
  //O = sum (se_sum_1-3)
  var o = parseFloat(document.getElementById("se_op_sum").value);
  document.getElementById("an_4").value = o.toFixed(2);

  //calculate environment (o - t) and firm (s - w)  Vectors
  var ev = o-t;  //environment factor
  document.getElementById("an_ev").value = ev.toFixed(2);
  var fv = s-w;  //Firm factor
  document.getElementById("an_fv").value = fv.toFixed(2);

  //Calculate leading strategy
  var ls = "";
  fontcolor = "";
  var img = "";
  if (ev>=0 && fv>=0){ls = "GROWTH"; fontcolor="green"; img = "10.5";}
  if (ev<=0 && fv>=0){ls = "RESPONSE"; fontcolor="yellow"; img = "1.5";}
  if (ev>=0 && fv<=0){ls = "LEVERAGE"; fontcolor="blue"; img = "7.5";}
  if (ev<=0 && fv<=0){ls = "SURVIVAL"; fontcolor="red"; img = "4.5";}
  document.getElementById("an_ls").value = ls;
  document.getElementById("an_ls").style.color = fontcolor;

  //Update chart
  newChart(s,t,w,o,img);
}


</script>